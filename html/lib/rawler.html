<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>rawler.rb</title>
  <link rel="stylesheet" href="http://github.com/jashkenas/docco/raw/0.3.0/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>rawler.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        <p><strong>Rawler</strong> is a command line tool for finding broken links on your website.
You can install Rawler by running:</p>

<p>  gem install rawler</p>

<p>To use Rawler type:</p>

<p>  rawler example.com</p>

<p>Type <code>rawler -h</code> to see all the available options (including basic auth support).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-Prerequisites'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Prerequisites">&#182;</a>
        </div>
        <h3>Prerequisites</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>We use <a href="http://www.ruby-doc.org/stdlib/libdoc/net/http/rdoc/index.html">net/https</a> for making requests.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="nb">require</span> <span class="s1">&#39;net/https&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-4">&#182;</a>
        </div>
        <p>We use <a href="http://nokogiri.org/">nokogiri</a> for parsing web pages.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="nb">require</span> <span class="s1">&#39;nokogiri&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <p>We use the <a href="http://www.ruby-doc.org/stdlib/libdoc/logger/rdoc/">logger</a> utility for handling the output.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="nb">require</span> <span class="s1">&#39;logger&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-6'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-6">&#182;</a>
        </div>
        <p>We require <a href="rawler/core_extensions.html">rawler/core_extensions</a> which includes some core extensions we need.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="nb">require</span> <span class="s1">&#39;rawler/core_extensions&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-The_Rawler_module'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-The_Rawler_module">&#182;</a>
        </div>
        <h3>The Rawler module</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-8'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-8">&#182;</a>
        </div>
        <p>The Rawler module itself is very simple, and it&rsquo;s only used for storing configuration data like the url that we want to fetch, basic username and password.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="k">module</span> <span class="nn">Rawler</span>
  <span class="no">VERSION</span> <span class="o">=</span> <span class="s1">&#39;0.1.0&#39;</span>
  </pre></div>
      </td>
    </tr>
    <tr id='section-9'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-9">&#182;</a>
        </div>
        <p><code>output</code> is where we want to direct output. It&rsquo;s set to <code>$stdout</code> by default.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="n">mattr_accessor</span> <span class="ss">:output</span></pre></div>
      </td>
    </tr>
    <tr id='section-10'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-10">&#182;</a>
        </div>
        <p><code>url</code> is the url that we want to fetch. We need to keep track of it when parsing other pages to see if they are of the same domain.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="n">mattr_accessor</span> <span class="ss">:url</span></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-11">&#182;</a>
        </div>
        <p>The time we wait between requests, default 3. We don&rsquo;t want to send too many requests to your website!</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="n">mattr_accessor</span> <span class="ss">:wait</span>
  </pre></div>
      </td>
    </tr>
    <tr id='section-12'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-12">&#182;</a>
        </div>
        <p>Username and Password for basic auth, if needed.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="n">mattr_accessor</span> <span class="ss">:username</span><span class="p">,</span> <span class="ss">:password</span>
  </pre></div>
      </td>
    </tr>
    <tr id='section-13'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-13">&#182;</a>
        </div>
        <p>Here we autoload when needed the specific namespaces.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-14'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-14">&#182;</a>
        </div>
        <p><a href="rawler/base.html">Rawler::Base</a> is responsible for validating all the pages in a domain. It&rsquo;s where all the magic happens.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="nb">autoload</span> <span class="ss">:Base</span><span class="p">,</span> <span class="s2">&quot;rawler/base&quot;</span></pre></div>
      </td>
    </tr>
    <tr id='section-15'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-15">&#182;</a>
        </div>
        <p><a href="rawler/crawler.html">Rawler::Crawler</a> is responsible for parsing links inside a page.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="nb">autoload</span> <span class="ss">:Crawler</span><span class="p">,</span> <span class="s2">&quot;rawler/crawler&quot;</span></pre></div>
      </td>
    </tr>
    <tr id='section-16'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-16">&#182;</a>
        </div>
        <p><a href="rawler/reqeust.html">Rawler::Request</a> contains some helper methods for performing requests.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="nb">autoload</span> <span class="ss">:Request</span><span class="p">,</span> <span class="s2">&quot;rawler/request&quot;</span></pre></div>
      </td>
    </tr>
    <tr id='section-17'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-17">&#182;</a>
        </div>
        <p>We overwrite url= to automatically add <code>http://</code> if needed so that you can simply type <code>rawler example.com</code> in the command line.</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">url</span><span class="o">=</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">url</span><span class="o">.</span><span class="n">strip!</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">url</span> <span class="o">=~</span> <span class="sr">/http:\/\//</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
      <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://&#39;</span> <span class="o">+</span> <span class="n">url</span>
    <span class="k">end</span>

    <span class="vc">@@url</span> <span class="o">=</span> <span class="n">url</span>
  <span class="k">end</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
